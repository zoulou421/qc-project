<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Module Category Definition -->
    <!-- Defines the category for grouping QC Project roles -->
    <record id="qcproject_module_category" model="ir.module.category">
        <field name="name">QC Project</field>
        <field name="description">Module for managing Quality Control projects and tracking</field>
    </record>

    <!-- User Groups Definition -->
    <!-- Employee group with basic access -->
    <record id="qcproject_group_employee" model="res.groups">
        <field name="name">QC Project Employee</field>
        <field name="category_id" ref="qcproject_module_category"/>
        <field name="comment">Grants basic access to QC project data, allowing employees to view their own records.</field>
        <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        <!-- Optional: Assign default users if needed -->
        <!-- <field name="users" eval="[(4, ref('base.some_default_user'))]"/> -->
    </record>

    <!-- Manager group with extended permissions -->
    <record id="qcproject_group_manager" model="res.groups">
        <field name="name">QC Project Manager</field>
        <field name="category_id" ref="qcproject_module_category"/>
        <field name="comment">Grants permissions to manage QC project data, including creating and editing records.</field>
        <field name="implied_ids" eval="[(4, ref('qcproject_group_employee'))]"/>
        <field name="users" eval="[(4, ref('base.user_root')), (4, ref('base.user_admin'))]"/>
    </record>

    <!-- Administrator group with full access -->
    <record id="qcproject_group_admin" model="res.groups">
        <field name="name">QC Project Administrator</field>
        <field name="category_id" ref="qcproject_module_category"/>
        <field name="comment">Grants full access to QC project data, including deletion of records.</field>
        <field name="implied_ids" eval="[(4, ref('qcproject_group_manager'))]"/>
    </record>

    <!-- Access Rights for QC Employee Model -->
    <!-- Employee access: read-only -->
    <record id="qcproject_access_employee" model="ir.model.access">
        <field name="name">QC Employee Access (Read-Only)</field>
        <field name="model_id" ref="model_qcproject_employee"/>
        <field name="group_id" ref="qcproject_group_employee"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="0"/>
        <field name="perm_create" eval="0"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Manager access: read, write, create -->
    <record id="qcproject_access_manager" model="ir.model.access">
        <field name="name">QC Manager Access (Read/Write/Create)</field>
        <field name="model_id" ref="model_qcproject_employee"/>
        <field name="group_id" ref="qcproject_group_manager"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Admin access: full permissions -->
    <record id="qcproject_access_admin" model="ir.model.access">
        <field name="name">QC Admin Access (Full Permissions)</field>
        <field name="model_id" ref="model_qcproject_employee"/>
        <field name="group_id" ref="qcproject_group_admin"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="1"/>
    </record>

    <!-- Access Rights for QC EmployeeRating Model -->
    <!-- Employee access: read-only -->
    <record id="qcproject_access_employeerating_employee" model="ir.model.access">
        <field name="name">QC EmployeeRating Access (Read-Only)</field>
        <field name="model_id" ref="model_qcproject_employeerating"/>
        <field name="group_id" ref="qcproject_group_employee"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="0"/>
        <field name="perm_create" eval="0"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Manager access: read, write, create -->
    <record id="qcproject_access_employeerating_manager" model="ir.model.access">
        <field name="name">QC EmployeeRating Access (Read/Write/Create)</field>
        <field name="model_id" ref="model_qcproject_employeerating"/>
        <field name="group_id" ref="qcproject_group_manager"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Admin access: full permissions -->
    <record id="qcproject_access_employeerating_admin" model="ir.model.access">
        <field name="name">QC EmployeeRating Access (Full Permissions)</field>
        <field name="model_id" ref="model_qcproject_employeerating"/>
        <field name="group_id" ref="qcproject_group_admin"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="1"/>
    </record>

    <!-- Access Rights for QC Project Model -->
    <!-- Employee access: read-only -->
    <record id="qcproject_access_project_employee" model="ir.model.access">
        <field name="name">QC Project Access (Read-Only)</field>
        <field name="model_id" ref="model_qcproject_project"/>
        <field name="group_id" ref="qcproject_group_employee"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="0"/>
        <field name="perm_create" eval="0"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Manager access: read, write, create -->
    <record id="qcproject_access_project_manager" model="ir.model.access">
        <field name="name">QC Project Access (Read/Write/Create)</field>
        <field name="model_id" ref="model_qcproject_project"/>
        <field name="group_id" ref="qcproject_group_manager"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Admin access: full permissions -->
    <record id="qcproject_access_project_admin" model="ir.model.access">
        <field name="name">QC Project Access (Full Permissions)</field>
        <field name="model_id" ref="model_qcproject_project"/>
        <field name="group_id" ref="qcproject_group_admin"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="1"/>
    </record>

    <!-- Record Rules for QC Employee Model -->
    <!-- Restrict employees to their own records -->
    <record id="qcproject_employee_own_record_rule" model="ir.rule">
        <field name="name">QC Employee: Own Records Only</field>
        <field name="model_id" ref="model_qcproject_employee"/>
        <field name="groups" eval="[(4, ref('qcproject_group_employee'))]"/>
        <field name="domain_force">[('user_id', '=', user.id)]</field>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="0"/>
        <field name="perm_create" eval="0"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Managers and Admins can access all records -->
    <record id="qcproject_employee_all_records_rule" model="ir.rule">
        <field name="name">QC Manager/Admin: All Records</field>
        <field name="model_id" ref="model_qcproject_employee"/>
        <field name="groups" eval="[(4, ref('qcproject_group_manager')), (4, ref('qcproject_group_admin'))]"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="1"/>
    </record>

    <!-- Record Rules for QC EmployeeRating Model -->
    <!-- Restrict employees to their own ratings (based on manager_id) -->
    <record id="qcproject_employeerating_own_record_rule" model="ir.rule">
        <field name="name">QC EmployeeRating: Own Records Only</field>
        <field name="model_id" ref="model_qcproject_employeerating"/>
        <field name="groups" eval="[(4, ref('qcproject_group_employee'))]"/>
        <field name="domain_force">[('manager_id', '=', user.id)]</field>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="0"/>
        <field name="perm_create" eval="0"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Managers and Admins can access all ratings -->
    <record id="qcproject_employeerating_all_records_rule" model="ir.rule">
        <field name="name">QC Manager/Admin: All EmployeeRatings</field>
        <field name="model_id" ref="model_qcproject_employeerating"/>
        <field name="groups" eval="[(4, ref('qcproject_group_manager')), (4, ref('qcproject_group_admin'))]"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="1"/>
    </record>

    <!-- Record Rules for QC Project Model -->
    <!-- Restrict employees to projects in their department -->
    <record id="qcproject_project_own_department_rule" model="ir.rule">
        <field name="name">QC Project: Own Department Projects Only</field>
        <field name="model_id" ref="model_qcproject_project"/>
        <field name="groups" eval="[(4, ref('qcproject_group_employee'))]"/>
        <field name="domain_force">[('department_id', 'in', user.employee_id.department_id.ids)]</field>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="0"/>
        <field name="perm_create" eval="0"/>
        <field name="perm_unlink" eval="0"/>
    </record>

    <!-- Managers and Admins can access all projects -->
    <record id="qcproject_project_all_records_rule" model="ir.rule">
        <field name="name">QC Manager/Admin: All Projects</field>
        <field name="model_id" ref="model_qcproject_project"/>
        <field name="groups" eval="[(4, ref('qcproject_group_manager')), (4, ref('qcproject_group_admin'))]"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="perm_read" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_create" eval="1"/>
        <field name="perm_unlink" eval="1"/>
    </record>

</odoo>